// generated by genGoStructApi.go
package api

import (
	"errors"

	"github.com/thomaspeugeot/metabaron/examples/laundromat/go/models"
)

// MachineAPI is the twin in the "api" namespace of Machine of the "models" namespace
//
// swagger:model MachineAPI
type MachineAPI struct {
	models.Machine

	IDAPI uint // unique ID of the instance in the "api" namespace
}

// CreateAPIMachine creates from machine an instance in the "api" namespace
// CreateAPIMachine performs a deep copy of machine fields
func (aPIGate *APIGateStruct) CreateAPIMachine(machine *models.Machine) (IDAPI uint, err error) {

	machineAPI := new(MachineAPI)

	IDAPI = aPIGate.lastMachineAPIID + 1
	aPIGate.lastMachineAPIID = IDAPI

	// update store
	aPIGate.MapMachineIDAPI[machine] = IDAPI
	aPIGate.MapIDAPIMachine[IDAPI] = machine
	aPIGate.MapMachineAPIIDAPI[machineAPI] = IDAPI
	aPIGate.MapIDAPIMachineAPI[IDAPI] = machineAPI
	return
}

// UpdateAPIMachine updates from machine an instance in the "api" namespace
// UpdateAPIMachine performs a deep copy of machine fields
func (aPIGate *APIGateStruct) UpdateAPIMachine(machine *models.Machine) (IDAPI uint, err error) {

	// check if twin ID exists
	var ok bool
	IDAPI, ok = aPIGate.MapMachineIDAPI[machine]
	if !ok {
		return uint(0), errors.New("unknown machine")
	}

	// get the twin API
	machineAPI := aPIGate.MapIDAPIMachineAPI[IDAPI]

	// update values of machineAPI with a deep copy
	machineAPI.Machine = *machine

	return
}
